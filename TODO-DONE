TODO8: abstract buffer editing away from command_handlers?
